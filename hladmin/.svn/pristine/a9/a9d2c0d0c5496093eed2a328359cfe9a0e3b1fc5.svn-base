<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Title</title>

    <link rel="stylesheet" href="css/style.default.css" type="text/css"/>
    <script type="text/javascript" src="js/plugins/jquery-1.7.min.js"></script>
    <script type="text/javascript" src="js/script.js"></script>
    <script type="text/javascript" src="js/MyPage.js"></script>
    <link rel="stylesheet" type="text/css" href="css/page.css"/>
</head>
<body>
<input type="hidden" id="type" th:value="${type}">
<div class="pageheader">
    <ul class="breadcrumbs">
        <li><a href="">内容</a></li>
        <li><a href="">站点设置</a></li>
        <li><a href="">管理栏目</a></li>
        <li>添加栏目</li>
    </ul>
</div>
<div id="contentwrapper" class="contentwrapper">

    <div style="margin-bottom: 5px">
        <input type="button" value="返回" class="stdbtn btn_black"
               onclick="goBack()">
    </div>
    <form th:if="${type} eq 'add'" class="stdform stdform2" action="/addCategory" method="post" id="forms">
        <p>
            <label>上级栏目：</label>
            <span class="field"  id="catList">

            </span>
        </p>
        <p>
            <label>所属站点</label>
            <span class="field">
                <input type="hidden" name="siteid"  id="siteid" th:value="${siteid}">
                <input class="mediuminput" type="text" th:value="${site.name}" disabled="disabled" />
            </span>
        </p>
        <p>
            <label>栏目名称：</label>
            <span class="field">
                <input  type="text" name="catname"  class="mediuminput lanmu"/>
            </span>
        </p>
        <p>
            <label>栏目Code</label>
            <span class="field" id="cat_code_list">

            </span>
        </p>
        <p>
            <label>是否按钮</label>
            <span class="field">
                <input type="radio" name="ismenu" checked="checked" value="0"/>否 &nbsp; &nbsp;
                <input type="radio" name="ismenu"  value="1"/> 是 &nbsp; &nbsp;
            </span>
        </p>
        <p>
            <label>描述：</label>
            <span class="field">
               <textarea name="description" maxlength="255" id="description" style="width: 50%; height: 48px; margin: 0px;"></textarea>
            </span>
        </p>

        <p class="stdformbutton">
            <button id="fromSubmit" class="radius2">提交</button>
            <input type="reset" class="reset radius2" value="清空"/>
        </p>
    </form>
    <form th:if="${type} eq 'edit'" class="stdform stdform2" action="/editCategory" method="post" id="editForms">
        <input type="hidden" th:value="${categoryById.catid}" id="catid" name="catid">
        <p>
            <label>上级栏目：</label>
            <span class="field"  id="catList">
                <input type="hidden" id="catParid" th:value="${categoryById.parentid}" />
            </span>
        </p>
        <p>
            <label>所属站点</label>
            <span class="field">
                <input type="hidden" name="siteid"  id="siteid" th:value="${siteid}">
                <input class="mediuminput" type="text" th:value="${site.name}" disabled="disabled" />
            </span>
        </p>
        <p>
            <label>栏目名称：</label>
            <span class="field">
                <input  type="text" name="catname"  class="mediuminput lanmu" th:value="${categoryById.name}"/>
            </span>
        </p>
        <p>
            <label>栏目Code</label>
            <span class="field" id="cat_code_list">
                <input type="hidden" id="catCode" th:value="${categoryById.cat_code}"/>
            </span>
        </p>
        <p>
            <label>描述：</label>
            <span class="field">
               <textarea name="description" maxlength="255" id="description" style="width: 50%; height: 48px; margin: 0px;" th:text="${categoryById.description}"></textarea>
            </span>
        </p>
        <p class="stdformbutton">
            <button id="editfromSubmit" class="radius2">提交</button>
            <input type="reset" class="reset radius2" value="清空"/>
        </p>
    </form>
    <script type="application/javascript">
        $("#fromSubmit").click(function () {
            var lanmu=$(".lanmu").val();
            if(lanmu==""){
                alert("请输入栏目名称！");
                return false;
            }
            if(lanmu.length>16){
                alert("栏目名称过长！");
                return false;
            }
            var cat_code=$("#cat_code").val();
            if(cat_code==""){
                alert("请选择栏目Code！");
                return false;
            }
            $("#forms").submit();
        });
        $("#editfromSubmit").click(function () {
            var lanmu=$(".langmu").val();
            if(lanmu==""){
                layer.msg("请输入栏目名称！");
                return false;
            }
            if(lanmu.length>16){
                layer.msg("栏目名称过长！");
                return false;
            }
            var mulu=$(".mulu").val();
            if(mulu==""){
                layer.msg("请输入英文目录！");
                return false;
            }

            $("#editForms").submit();
        });

        $.ajax({
            url:"/CateLocationList",
            dataType:"json",
            type:"get",
            success:function (data) {
                var html = "";
                html+="<select name='cat_code' id='cat_code'><option value=''>请选择栏目位置</option>";
                for(var i in data){
                    html+= "<option value='"+data[i].cat_code+"'>"+data[i].name+"</option>";
                }
                html+="</select>";
                $("#cat_code_list").append(html);
                $("#cat_code").val($("#catCode").val());
            }
        });

        var siteid = $("#siteid").val();
        $.ajax({
            url:"/getCateList",
            dataType:"json",
            type:"post",
            data:{"siteid":siteid},
            success:function (data) {
                var html = "";
                html+="<select name='catparid' id='catparid'><option value=''>一级栏目(默认)</option>";
                for(var i in data){
                    html+= "<option value='"+data[i].catid+"'>"+data[i].name+"</option>";
                }
                html+="</select>";
                $("#catList").append(html);
                $("#catparid").val($("#catParid").val());
            }
        });

        function goBack() {
            var siteid = $("#siteid").val();
            var url = "/goManager?siteid="+siteid;
            window.location.href=url;
        }
    </script>
</div>
</body>
</html>
