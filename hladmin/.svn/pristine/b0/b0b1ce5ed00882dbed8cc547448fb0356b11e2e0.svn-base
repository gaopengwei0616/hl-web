<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>控制台页面</title>


    <link rel="stylesheet" href="css/style.default.css" type="text/css"/>
    <script type="text/javascript" src="js/plugins/jquery-1.7.min.js"></script>
    <script type="text/javascript" src="js/script.js"></script>
    <script type="text/javascript" src="js/MyPage.js"></script>
    <link rel="stylesheet" type="text/css" href="css/page.css"/>


    <!--[if lte IE 8]>
    <script language="javascript" type="text/javascript" src="js/plugins/excanvas.min.js"></script><![endif]-->
    <!--[if IE 9]>
    <link rel="stylesheet" media="screen" href="css/style.ie9.css"/>
    <![endif]-->
    <!--[if IE 8]>
    <link rel="stylesheet" media="screen" href="css/style.ie8.css"/>
    <![endif]-->
    <!--[if lt IE 9]>
    <script src="js/plugins/css3-mediaqueries.js"></script>
    <![endif]-->
</head>
<script type="text/javascript">
    $(function () {
        $('#all').click(function () {

            if ($(this).prop('checked')) {
                $('#datalist :checkbox').prop('checked', true);
            } else {
                $('#datalist :checkbox').prop('checked', false);
            }

        });
    });
</script>
<body>

<div class="pageheader">
    <ul class="breadcrumbs">
        <li><a href="">内容</a></li>
        <li><a href="">内容附件管理</a></li>
        <li>附件管理</li>
    </ul>
</div><!--pageheader-->
<div id="contentwrapper" class="contentwrapper">

    <div style="margin-bottom: 5px">
        <input type="button" value="附件管理" class="stdbtn btn_black">
    </div>
    <div id="datalist">
        <table cellpadding="0" cellspacing="0" border="0" class="stdtable" id="dyntable2">
            <colgroup>
                <col class="con0" style="width: 4%"/>
                <col class="con1" style="width: 8%"/>
                <col class="con0" style="width: 6%"/>
                <col class="con1" style="width: 10%"/>
                <col class="con0" style="width: 20%"/>
                <col class="con1" style="width: 10%"/>
                <col class="con0" style="width: 20%"/>
                <col class="con1" style="width: 16%"/>
            </colgroup>
            <thead>
            <tr>
                <th class="head0 nosort"><input type="checkbox" id="all"/></th>
                <th class="head0">附件ID</th>
                <th class="head1">模板名称</th>
                <th class="head0">文件类型</th>
                <th class="head1">附件名称</th>
                <th class="head0">附件大小</th>
                <th class="head0">上传时间</th>
                <th class="head0">管理操作</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="list:${pageList}">
                <td align="center"><span class="center"><input type='checkbox'/></span></td>
                <td th:text="${list.aid}"></td>
                <td th:text="${list.module}"></td>
                <td th:text="${list.fileext}"></td>
                <td th:text="${list.filename}"></td>
                <td th:text="${list.filesize}+'&nbsp;Bytes'"></td>
                <td th:text="${list.uploadtime}"></td>
                <td>
                    <button class="stdbtn btn_black"><a style="color: #FFFFFF" th:href="@{/uploaded/{filename}(filename=${list.filepath})}">预览</a></button>
                    <button class="stdbtn btn_black" th:onclick="|del('${list.aid}')|" th:value="${list.aid}">删除</button>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="pages">
        <span th:text="'显示'+${page.pageSize}+'条'"></span>
        <span id="page_total" th:value="${page.total}" th:text="'共有'+${page.total}+'条记录'"></span>
        <span th:value="${page.pages}" th:text="'共有'+${page.pages}+'页'"></span>
        <span class="page" id="Page" style="float: right"></span>
    </div>
    <input type="hidden" id="value" th:value="${value}"/>
    <!--以下为公共部分-->
    <script>
        var total = $("#page_total").attr("value");
        P.initMathod({
            params: {
                elemId: '#Page',
                total: this.total
            }, requestFunction: function (pageIndex) {
                if ($("#value").val() == 1) {
                    $("#value").val(0);
                    return;
                }
                var catid = $("#catid").val();
                window.location.href = "/Attachmentlist?pageNum=" + pageIndex;
            }
        });
        //删除确认框
        function del(data) {
            if (confirm("您确定要删除吗？")) {
                $.ajax({
                    type: "POST",
                    url: "/delectByid",
                    data: {
                        "aid": data
                    },//数据，这里使用的是Json格式进行传输
                    success: function (data) {//返回数据根据结果进行相应的处理
                        if (data == 1) {
                            alert("删除成功！");
                            window.location.href = "/Attachmentlist";
                        } else {
                            alert("删除失败！");
                        }
                    }
                });
                return true;
            } else {
                return false;
            }


        };
        //预览图片
        function show(data) {
            alert(data);
        }
    </script>
</div><!-- centercontent -->

</body>
</html>
